<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue2 二级菜单组件</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .menu-container {
            width: 300px;
            background: #f5f5f5;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .menu-item {
            cursor: pointer;
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            transition: all 0.3s;
            position: relative;
        }
        .menu-item:hover {
            background: #e9e9e9;
        }
        .menu-item.active {
            background: #42b983;
            color: white;
        }
        .menu-item.has-children::after {
            content: ">";
            position: absolute;
            right: 15px;
            transform: rotate(90deg);
            transition: transform 0.3s;
        }
        .menu-item.has-children.expanded::after {
            transform: rotate(-90deg);
        }
        .sub-menu {
            padding-left: 20px;
            background: #e9e9e9;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .sub-menu.expanded {
            max-height: 1000px;
        }
    </style>
</head>

<body>
    <div id="app">
        <div class="menu-container">
            <div v-for="item in menuData" :key="item.id">
                <!-- 一级 -->
                <div 
                    class="menu-item" :class="{
                    'active': item.id === activeId,
                    'has-children':hasChildren(item),
                    'expanded': expandedItems.includes(item.id)
                }" @click="handleItemClick(item)" >
                    {{item.name}}
                </div>
                <!-- 二级 -->
                <div class="sub-menu" :class="{
                    'expanded':expandedItems.includes(item.id)}"
                    v-if="hasChildren(item)"
                >
                    <div v-for="child in item.children" :key="child.id">
                        <!-- .stop取消向上冒泡 -->
                        <div class="menu-item"
                            :class="{
                                'active':child.id === activeId,
                                'hasChildren':hasChildren(child),
                                'expanded':expandedItems.includes(child.id)
                            }" @click.stop="handleItemClick(child)" 
                        >
                            {{child.name}}
                        </div>
                        <!-- 三级 -->
                        <div class="sub-menu"
                            :class="{'expanded':expandedItems.includes(child.id)}"
                            v-if="hasChildren(child)"
                        >
                            <div v-for="subChild in child.children"
                                :key="subChild.id"
                                class="menu-item"
                                :class="{'active':subChild.id === activeId}"
                                @click.stop="handleItemClick(subChild)"

                            >
                            {{subChild.name}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <p style="margin-top: 20px;">当前选中项ID：{{ activeId }}</p>
    </div>

    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    activeId:null,
                    expandedItems:[],
                    menuData: [
                        {
                            id: 1, name: '首页', children: []
                        },
                        {
                            id: 2, name: '产品中心',
                            children: [
                                {
                                    id: 21, name: '产品分类1', children: []
                                },
                                {
                                    id: 22, name: '产品分类2', children: []
                                },
                                {
                                    id: 23, name: '产品分类3',
                                    children: [
                                        {
                                            id: 231, name: '子产品1', children: []
                                        },
                                        {
                                            id: 232, name: '子产品2', children: []
                                        },
                                    ]
                                },
                            ]
                        },
                        {
                            id: 3, name: '关于我们',
                            children: [
                                {
                                    id: 31, name: '公司简介', children: []
                                },
                                {
                                    id: 32, name: '联系我们', children: []
                                },
                            ]
                        },
                        {
                            id: 4, name: '新闻动态', children: []
                        },
                    ]
                }
            },
            methods: {
                hasChildren(item){
                    return item.children && item.children.length > 0
                },
                handleItemClick(item){
                    if(this.hasChildren(item)){
                        const index = this.expandedItems.indexOf(item.id)
                        if (index > -1) {
                            this.expandedItems.splice(index, 1);
                        }else{
                            this.expandedItems.push(item.id);
                        }
                    }else{
                        this.activeId = item.id;
                    }
                }
            }
        })
    </script>
</body>

</html>